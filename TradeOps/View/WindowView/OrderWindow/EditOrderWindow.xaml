<Window
    x:Class="TradeOps.View.WindowView.OrderWindow.EditOrderWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
    Title="Edit Order"
    Width="800"
    Height="600"
    DataContext="{Binding}"
    WindowStartupLocation="CenterOwner"
    WindowState="Maximized">

    <Border Padding="10" Background="white">
        <Grid Margin="0" Background="White">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
                <RowDefinition Height="*" />
            </Grid.RowDefinitions>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="8*" />

                <ColumnDefinition Width="2*" />
            </Grid.ColumnDefinitions>


            <!--  Select Customer  -->
            <StackPanel
                Grid.Row="0"
                Margin="0,0,0,10"
                Orientation="Horizontal">
                <TextBlock
                    Margin="0,0,5,0"
                    VerticalAlignment="Center"
                    FontSize="18"
                    Text="Customer:" />
                <ComboBox
                    Width="200"
                    DisplayMemberPath="Name"
                    FontSize="18"
                    ItemsSource="{Binding Customers}"
                    SelectedItem="{Binding SelectedCustomer, Mode=TwoWay}" />

                <CheckBox
                    Margin="30,0,0,0"
                    Content="Order Completed"
                    FontSize="18"
                    IsChecked="{Binding Complete}" />
                <Button
                    Margin="10,0,0,0"
                    Command="{Binding ShowProductPickerCommand}"
                    Content="Add Product"
                    FontSize="18"
                    Foreground="White" />
            </StackPanel>

            <!--  Select Product and Quantity  -->
            <!--<StackPanel
                Grid.Row="1"
                Margin="0,0,0,10"
                Orientation="Horizontal">
                <TextBlock
                    Margin="0,0,5,0"
                    VerticalAlignment="Center"
                    FontSize="18"
                    Text="Product:" />
                <ComboBox
                    Width="200"
                    Margin="0,0,10,0"
                    DisplayMemberPath="Name"
                    FontSize="18"
                    ItemsSource="{Binding Products}"
                    SelectedItem="{Binding SelectedProduct, Mode=TwoWay}" />

                <TextBlock
                    Margin="0,0,5,0"
                    VerticalAlignment="Center"
                    FontSize="18"
                    Text="Quantity:" />
                <TextBox
                    Width="100"
                    Margin="0,0,10,0"
                    FontSize="18"
                    LostFocus="TextBox_RestoreZeroIfEmpty"
                    PreviewGotKeyboardFocus="TextBox_SelectAll_IfZero"
                    PreviewTextInput="NumberOnly_PreviewTextInput"
                    Text="{Binding EnteredQuantity}" />

                <Button
                    Command="{Binding AddProductCommand}"
                    Content="Add Product"
                    FontSize="18"
                    Foreground="White" />

            </StackPanel>-->

            <!--  Order Details Table  -->
            <DataGrid
                Grid.Row="2"
                AutoGenerateColumns="False"
                CanUserAddRows="False"
                ItemsSource="{Binding CurrentOrderDetails}">
                <DataGrid.Columns>
                    <DataGridTextColumn
                        Width="*"
                        Binding="{Binding Product.Name}"
                        FontSize="18"
                        Header="Product" />
                    <DataGridTextColumn
                        Width="*"
                        Binding="{Binding Quantity}"
                        FontSize="18"
                        Header="Qty" />
                    <DataGridTextColumn
                        Width="*"
                        Binding="{Binding Product.PurchasePrice}"
                        FontSize="18"
                        Header="Purchase Price" />
                    <DataGridTextColumn
                        Width="*"
                        Binding="{Binding Product.SellingPrice}"
                        FontSize="18"
                        Header="Sale Price" />
                    <DataGridTextColumn
                        Width="*"
                        Binding="{Binding SubTotal}"
                        FontSize="18"
                        Header="Subtotal"
                        IsReadOnly="True" />
                    <DataGridTextColumn
                        Width="*"
                        Binding="{Binding SubProfit}"
                        FontSize="18"
                        Header="Profit"
                        IsReadOnly="True" />
                    <DataGridTemplateColumn Width="auto" Header="Delete">
                        <DataGridTemplateColumn.CellTemplate>
                            <DataTemplate>
                                <Button
                                    Margin="-5"
                                    Padding="0"
                                    Command="{Binding DataContext.RemoveProductCommand, RelativeSource={RelativeSource AncestorType=Window}}"
                                    CommandParameter="{Binding}"
                                    Style="{StaticResource MaterialDesignToolButton}">
                                    <materialDesign:PackIcon FontSize="18" Kind="Close" />
                                </Button>
                            </DataTemplate>
                        </DataGridTemplateColumn.CellTemplate>
                    </DataGridTemplateColumn>
                </DataGrid.Columns>
            </DataGrid>

            <!--  Summary and Save  -->
            <Border
                Grid.Row="0"
                Grid.RowSpan="3"
                Grid.Column="2"
                BorderBrush="Gray"
                BorderThickness="2,0,0,0">
                <Grid
                    HorizontalAlignment="Stretch"
                    VerticalAlignment="Stretch"
                    Background="White">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="*" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="auto" />
                    </Grid.RowDefinitions>
                    <StackPanel
                        Grid.Row="1"
                        Margin="10"
                        Orientation="Horizontal">
                        <TextBlock
                            Margin="10,0,5,0"
                            VerticalAlignment="Center"
                            FontSize="18"
                            FontWeight="Medium"
                            Text="Total Qty:" />
                        <TextBlock
                            Margin="20,0,5,0"
                            FontSize="18"
                            Text="{Binding TotalQuantity}" />
                    </StackPanel>
                    <StackPanel
                        Grid.Row="2"
                        Margin="10"
                        Orientation="Horizontal">
                        <TextBlock
                            Margin="10,0,5,0"
                            VerticalAlignment="Center"
                            FontSize="18"
                            FontWeight="Medium"
                            Text="Profit:" />
                        <TextBlock
                            Margin="20,0,5,0"
                            FontSize="18"
                            Text="{Binding TotalProfit}" />
                    </StackPanel>
                    <StackPanel
                        Grid.Row="3"
                        Margin="10,10,10,30"
                        Orientation="Horizontal">
                        <TextBlock
                            Margin="10,0,5,0"
                            VerticalAlignment="Center"
                            FontSize="18"
                            FontWeight="Medium"
                            Text="Total:" />
                        <TextBlock
                            Margin="20,0,5,0"
                            FontSize="18"
                            Text="{Binding TotalAmount}" />
                    </StackPanel>
                    <Button
                        Grid.Row="4"
                        Width="120"
                        Command="{Binding SaveOrderCommand}"
                        Content="Save Order"
                        FontSize="18"
                        Foreground="White" />

                </Grid>
            </Border>
        </Grid>
    </Border>

</Window>
